$(function(){jQuery.ax=function(h,k,j,i,g,m,l){j=(j==null||j.length==0||typeof(j)=="undefined")?"true":j;i=(i==null||i==""||typeof(i)=="undefined")?"post":i;g=(g==null||g==""||typeof(g)=="undefined")?"json":g;k=(k==null||k==""||typeof(k)=="undefined")?{"date":new Date().getTime()}:k;$.ajax({type:i,async:j,data:k,url:h,dataType:g,success:function(n){m(n)},error:function(n){l(n)}})};jQuery.axs=function(g,h,i){h=(h==null||h==""||typeof(h)=="undefined")?{"date":new Date().getTime()}:h;$.ajax({type:"post",data:h,url:g,dataType:"json",success:function(j){i(j)}})};jQuery.axse=function(g,h,j,i){h=(h==null||h==""||typeof(h)=="undefined")?{"date":new Date().getTime()}:h;$.ajax({type:"post",data:h,url:g,dataType:"json",success:function(k){j(k)},error:function(k){i(k)}})};var d={lang:"zh-cn"};var f={"zh-cn":{aMonths:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],aLongMonths:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],aWeeks:["日","一","二","三","四","五","六"],aLongWeeks:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],a:["上午","下午"]},"en":{aMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],aLongMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],aWeeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],aLongWeeks:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a:["AM","PM"]}};var b=/^(y+|M+|d+|H+|h+|m+|s+|E+|S|a)/;var a;jQuery.formatDate=function(l,h,r){a=$.extend({},d,f[$.extend({},d,r).lang],r);if(h==undefined){h=new Date()}if($.type(h)==="string"){if(h==""){return""}else{var n=h.replace(/-/g,"/").split(/\/|\:|\ /);var m=null;var k=null;var o=null;var j=null;var i=null;var p=null;if(n.length>0){m=n[0]}if(n.length>1){k=n[1]-1}if(n.length>2){o=n[2]}if(n.length>3){j=n[3]}if(n.length>4){i=n[4]}if(n.length>5){p=n[5]}h=new Date(m,k,o,j,i,p)}}var q=[];while(l.length>0){b.lastIndex=0;var g=b.exec(l);if(g){q.push(e[g[0]](h));l=l.slice(g[0].length)}else{q.push(l.charAt(0));l=l.slice(1)}}return q.join("")};function c(i,h){var g="00"+i.toString();return g.substr(g.length-h)}var e={y:function(g){return g.getFullYear().toString().length>1?c(g.getFullYear(),2):c(g.getFullYear(),1)},yy:function(g){return c(g.getFullYear(),2)},yyy:function(g){return c(g.getFullYear(),3)},yyyy:function(g){return g.getFullYear().toString()},M:function(g){return g.getMonth()+1},MM:function(g){return c(g.getMonth()+1,2)},MMM:function(g){return a.aMonths[g.getMonth()]},MMMM:function(g){return a.aLongMonths[g.getMonth()]},d:function(g){return g.getDate()},dd:function(g){return c(g.getDate(),2)},E:function(g){return a.aWeeks[g.getDay()]},EE:function(g){return a.aLongWeeks[g.getDay()]},H:function(g){return g.getHours()},HH:function(g){return c(g.getHours(),2)},h:function(g){return g.getHours()%12},hh:function(g){return c(g.getHours()>12?g.getHours()-12:g.getHours(),2)},m:function(g){return g.getMinutes()},mm:function(g){return c(g.getMinutes(),2)},s:function(g){return g.getSeconds()},ss:function(g){return c(g.getSeconds(),2)},S:function(g){return c(g.getMilliseconds(),3)},a:function(g){return a.a[g.getHours()<12?0:1]}};$.fn.serializeObject=function(){var h={};var g=this.serializeArray();$.each(g,function(){if(h[this.name]!==undefined){if(!h[this.name].push){h[this.name]=[h[this.name]]}h[this.name].push(this.value||"")}else{h[this.name]=this.value||""}});return h}});Date.prototype.format=function(a){var b=this;var c=function(g,f){if(!f){f=2}g=String(g);for(var e=0,d="";e<(f-g.length);e++){d+="0"}return d+g};return a.replace(/"[^"]*"|'[^']*'|\b(?:d{1,4}|m{1,4}|yy(?:yy)?|([hHMstT])\1?|[lLZ])\b/g,function(e){switch(e){case"d":return b.getDate();case"dd":return c(b.getDate());case"ddd":return["Sun","Mon","Tue","Wed","Thr","Fri","Sat"][b.getDay()];case"dddd":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][b.getDay()];case"M":return b.getMonth()+1;case"MM":return c(b.getMonth()+1);case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][b.getMonth()];case"MMMM":return["January","February","March","April","May","June","July","August","September","October","November","December"][b.getMonth()];case"yy":return String(b.getFullYear()).substr(2);case"yyyy":return b.getFullYear();case"h":return b.getHours()%12||12;case"hh":return c(b.getHours()%12||12);case"H":return b.getHours();case"HH":return c(b.getHours());case"m":return b.getMinutes();case"mm":return c(b.getMinutes());case"s":return b.getSeconds();case"ss":return c(b.getSeconds());case"l":return c(b.getMilliseconds(),3);case"L":var d=b.getMilliseconds();if(d>99){d=Math.round(d/10)}return c(d);case"tt":return b.getHours()<12?"am":"pm";case"TT":return b.getHours()<12?"AM":"PM";case"Z":return b.toUTCString().match(/[A-Z]+$/);default:return e.substr(1,e.length-2)}})};function slideMenu(a,b){$(a).parent().parent().find("ul").slideUp();$(a).parent().parent().find("span").removeClass("hide_close_"+b).addClass("hide_open_"+b);if($(a).next("ul").is(":hidden")){$(a).children("span").removeClass("hide_open_"+b).addClass("hide_close_"+b);$(a).next("ul").slideDown()}else{$(a).children("span").removeClass("hide_close_"+b).addClass("hide_open_"+b);$(a).next("ul").slideUp()}}function getSearchFormAndreloadDataGrid(formObj,datagridObj){var queryParamObjs=$("#"+formObj).children(".commSearchCond");var conditions=[];$(queryParamObjs).each(function(){var curDiv=$(this);if(curDiv.attr("hideEffect")!=null&&curDiv.attr("hideEffect")!="undefined"&&curDiv.attr("hideEffect")=="false"){if(!curDiv.is(":visible")){return}}var queryParamIpts=curDiv.find(":input[name]");var condition={};condition["name"]=curDiv.attr("name");condition["params"]=[];$(queryParamIpts).each(function(){if(typeof($(this).attr("name"))!="undefined"){var name=$(this).attr("name");if($(this)[0].tagName.toUpperCase()=="SELECT"){var selOpts=$(this).find("option:selected");$(selOpts).each(function(){var value=$(this).attr("value");if(null!=value&&value.length>0){var optPair={};optPair["key"]=name;optPair["value"]=value;optPair["type"]=$(this).attr("type");if(typeof($(this).attr("attrId"))!="undefined"){var attrId=$(this).attr("attrId");if($("#oper_"+attrId).length>0){var attrOper=$("#oper_"+attrId).val();if(null!=attrOper&&attrOper.length>0&&attrOper!=""){optPair["operator"]=attrOper}else{if(typeof($(this).attr("opers"))!="undefined"){optPair["operator"]=$(this).attr("opers")}}}}condition["params"].push(optPair)}})}else{if($(this).attr("type").toUpperCase()=="CHECKBOX"||$(this).attr("type").toUpperCase()=="RADIO"){if($(this).prop("checked")){var value=$(this).attr("value");if(null!=value&&value.length>0){var optPair={};optPair["key"]=name;optPair["value"]=value;optPair["type"]=$(this).attr("type");if(typeof($(this).attr("attrId"))!="undefined"){var attrId=$(this).attr("attrId");if($("#oper_"+attrId).length>0){var attrOper=$("#oper_"+attrId).val();if(null!=attrOper&&attrOper.length>0&&attrOper!=""){optPair["operator"]=attrOper}else{if(typeof($(this).attr("opers"))!="undefined"){optPair["operator"]=$(this).attr("opers")}}}}condition["params"].push(optPair)}}}else{var value=$(this).attr("value");if(null!=value&&value.length>0){var optPair={};optPair["key"]=name;optPair["value"]=value;optPair["type"]=$(this).attr("type");if($(this).attr("type").toUpperCase()=="HIDDEN"){var dateopr=$(this).parents("span[name='sp_"+name+"']").find("*[dateoper='true']");if(typeof(dateopr)!="undefined"){optPair["operator"]=$(dateopr).val();var operId=$(dateopr).attr("id");if(typeof(operId)!="undefined"){var attrId=operId.replace("oper_","");if(typeof($("#"+attrId))!="undefined"&&typeof($("#"+attrId).attr("edittype"))!="undefined"){optPair["attrType"]=$("#"+attrId).attr("edittype")}}}}else{if(typeof($(this).attr("attrId"))!="undefined"){var attrId=$(this).attr("attrId");if($("#oper_"+attrId).length>0){var attrOper=$("#oper_"+attrId).val();if(null!=attrOper&&attrOper.length>0&&attrOper!=""){optPair["operator"]=attrOper}else{if(typeof($(this).attr("opers"))!="undefined"){optPair["operator"]=$(this).attr("opers")}}}}}condition["params"].push(optPair)}}}}});conditions.push(condition)});var dgQueryParams=$("#"+datagridObj).datagrid("options").queryParams;if(!dgQueryParams){dgQueryParams={};$("#"+datagridObj).datagrid("options").queryParams=dgQueryParams}dgQueryParams["conditions"]=JSON.stringify(conditions);eval("set"+datagridObj+"URL()")}function reloadQueryFrm(a){$("#"+a+" :input").not(":button, :submit, :reset, :radio, :checkbox").not("*[dateoper='true']").not("*[isMultiSelect='true']").val("").removeAttr("checked").remove("selected");$("#"+a+" :input").filter(":radio, :checkbox").removeAttr("checked");$("#"+a).find(".multiSelect").find("span").text("请选择");$("#"+a).find(".multiSelectOptions").find("label").removeClass();$("#"+a).find(".multiSelectOptions").find("input[type='checkbox']").removeAttr("checked");$selts=$("#"+a).find("select");$selts.each(function(){var b=$(this).attr("id");var c=$(this).attr("class");if(c&&c.indexOf("easyui-combobox")!=(-1)){$("#"+b).combobox("clear")}})}var cache={};var staticDataUrl="commonController.do?listData";function reLoadOptionsData(a,i,c,b,g,e){var d=cache["listdata_"+g+"_"+e];if(null==d){params={"datalistId":g,"params":e};$.ax(a,params,false,"post","json",function(m){var l=$.parseJSON(m.result);d=l;cache[("listdata_"+g+"_"+e)]=l},function(){})}$("#"+c).html("");if("checkbox"==i||"radio"==i){$("#"+c).append("<div style='margin-top:10px;'>")}if("select"==i){$("#"+c).append("<option attrId='"+c+"' value=''>请选择</option>")}for(var f in d){var k=d[f]["key"];var j=d[f]["value"];var h=j;if(null!=j&&$.trim(j)!=""&&j.length>6){h=j.substring(0,6)+"..."}switch(i){case"select":$("#"+c).append("<option attrId='"+c+"' value='"+k+"'>"+d[f]["value"]+"</option>");break;case"checkbox":$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='checkbox' id='"+b+"_"+k+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+k+"'><label for='"+b+"_"+k+"' title='"+j+"' style='cursor:pointer;'>&nbsp;"+h+"</label></li>");break;case"radio":$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='radio' id='"+b+"_"+k+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+k+"'><label for='"+b+"_"+k+"' title='"+j+"' style='cursor:pointer;'>&nbsp;"+h+"</label></li>");break}}if("checkbox"==i||"radio"==i){$("#"+c).append("<div>")}}function loadSelectIsChoose(a,j,c,b,h,e,g){var d=cache["listdata_"+h+"_"+e];if(null==d){params={"datalistId":h,"params":e};$.ax(a,params,false,"post","json",function(n){var m=$.parseJSON(n.result);d=m;cache[("listdata_"+h+"_"+e)]=m},function(){})}$("#"+c).html("");if("checkbox"==j||"radio"==j){$("#"+c).append("<div style='margin-top:10px;'>")}if("select"==j){$("#"+c).append("<option attrId='"+c+"' value=''>请选择</option>")}for(var f in d){var l=d[f]["key"];var k=d[f]["value"];var i=k;if(null!=k&&$.trim(k)!=""&&k.length>6){i=k.substring(0,6)+"..."}switch(j){case"select":if($.inArray(l,g)>=0){$("#"+c).append("<option attrId='"+c+"' value='"+l+"' selected='selected'>"+d[f]["value"]+"</option>")}else{$("#"+c).append("<option attrId='"+c+"' value='"+l+"'>"+d[f]["value"]+"</option>")}break;case"checkbox":if($.inArray(l,g)>=0){$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='checkbox' id='"+b+"_"+l+"' checked='checked' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+l+"' parentid='"+e+"'><label title='"+k+"' ckid='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}else{$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='checkbox' id='"+b+"_"+l+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+l+"' parentid='"+e+"'><label title='"+k+"' ckid='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}break;case"radio":if($.inArray(l,g)>=0){$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='radio' id='"+b+"_"+l+"' checked='checked' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+l+"' parentid='"+e+"'><label title='"+k+"' ckid='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}else{$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='radio' id='"+b+"_"+l+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+l+"' parentid='"+e+"'><label title='"+k+"' ckid='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}break}}if("checkbox"==j||"radio"==j){$("#"+c).append("<div>")}}function reLoadGeoData(a,j,c,b,h,e,g){var d=cache["listdata_"+h+"_"+e];if(null==d){params={"datalistId":h,"params":e};$.ax(a,params,false,"post","json",function(o){var n=$.parseJSON(o.result);d=n;cache[("listdata_"+h+"_"+e)]=n},function(){})}var k=g;$("#"+c).html("");for(var f in d){var m=d[f]["key"];var l=d[f]["value"];var i=l;if(null!=l&&$.trim(l)!=""&&l.length>6){i=l.substring(0,6)+"..."}switch(j){case"select":if(k==m){$("#"+c).append("<option attrId='"+c+"' value='"+m+"' selected='selected'>"+d[f]["value"]+"</option>")}else{$("#"+c).append("<option attrId='"+c+"' value='"+m+"'>"+d[f]["value"]+"</option>")}break;case"checkbox":if(k==m){$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='checkbox' checked='checked' id='"+b+"_"+m+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+m+"'><label for='"+b+"_"+m+"' title='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}else{$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='checkbox' id='"+b+"_"+m+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+m+"'><label for='"+b+"_"+m+"' title='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}break;case"radio":if(k==m){$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='radio' checked='checked' id='"+b+"_"+m+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+m+"'><label for='"+b+"_"+m+"' title='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}else{$("#"+c).append("<li style='width:150px !important;height:22px !important;list-style:none;float:left;'><input type='radio' id='"+b+"_"+m+"' attrId='"+c+"' name='"+b+"' loadId='"+b+"' value='"+m+"'><label for='"+b+"_"+m+"' title='"+l+"' style='cursor:pointer;'>&nbsp;"+i+"</label></li>")}break}}}function replaceColShow(e,c,b,f){var d="";if("dgAppendSumRow"==e){return"<b>合计：</b>"}if("thisVal"==f){f=e}var g=cache["listdata_"+b+"_"+f];if(null==g){params={"datalistId":b,"params":f};$.ax(c,params,false,"post","json",function(i){var h=$.parseJSON(i.result);g=h;cache[("listdata_"+b+"_"+f)]=h},function(){})}for(var a in g){if(e==g[a]["key"]){d=g[a]["value"];break}else{d=""}}return d}function formatNumberCol(c,d,e,b){var a=c;if(typeof(c)!="undefined"){if("dateNumber"==d&&null!=c){return splitDateNum(c,null)}}return a}function getSourceList(a,b){var c=cache["listdata_"+a+"_"+b];if(null==c){params={"datalistId":a,"params":b};$.ax(staticDataUrl,params,false,"post","json",function(e){var d=$.parseJSON(e.result);c=d;cache[("listdata_"+a+"_"+b)]=d},function(){})}return c}function reLoadFormOptions(a,c,b){$.ax(a,b,null,"post","json",function(i){var m=i.result;for(var g in m){if($("#"+c).find("*[loadId='"+g+"']").get(0)){var l=$("*[loadId='"+g+"']").get(0).tagName;var j=$("*[loadId='"+g+"']").attr("type");var h;if(typeof(m[g])=="string"&&m[g].indexOf(",")){h=m[g].split(",")}if("SPAN"==l.toUpperCase()||"FONT"==l.toUpperCase()||"DIV"==l.toUpperCase()||"LABEL"==l.toUpperCase()){$("*[loadId='"+g+"']").html(m[g])}if("INPUT"==l.toUpperCase()&&j&&("RADIO"==j.toUpperCase()||"CHECKBOX"==j.toUpperCase())){$("#"+c).find("input[name='"+g+"']").each(function(){if($(this).attr("value")==m[g]||($(this).attr("name")==g&&$.inArray($(this).attr("value"),h)>=0)){$(this).attr("checked","checked")}})}if("INPUT"==l.toUpperCase()){if(!j||("RADIO"!=j.toUpperCase()&&"CHECKBOX"!=j.toUpperCase())){var f=$("*[loadId='"+g+"']");var k=$(f).attr("dateFormatter");var d=$(f).attr("dateNumFormatter");if(k&&null!=m[g]){var e=new Date(m[g]);$(f).val(e.format(k))}else{if(d&&null!=m[g]){$(f).val(splitDateNum(m[g],d))}else{$(f).val(m[g])}}}}if("SELECT"==l.toUpperCase()){$("#"+c).find("*[loadId='"+g+"']").find("option").each(function(){if($(this).attr("value")==m[g]){$(this).attr("selected","selected")}})}}}},function(){})}function reLoadFormValue(a,d,c,b){$.ax(a,c,null,"post","json",function(j){var n=j.result;for(var h in n){if($("#"+d).find("*[loadId='"+h+"']").get(0)){var m=$("*[loadId='"+h+"']").get(0).tagName;var k=$("*[loadId='"+h+"']").attr("type");var i;if(typeof(n[h])=="string"&&n[h].indexOf(",")){i=n[h].split(",")}if("SPAN"==m.toUpperCase()||"FONT"==m.toUpperCase()||"DIV"==m.toUpperCase()||"LABEL"==m.toUpperCase()){$("*[loadId='"+h+"']").html(n[h])}if("INPUT"==m.toUpperCase()&&k&&("RADIO"==k.toUpperCase()||"CHECKBOX"==k.toUpperCase())){$("#"+d).find("input[name='"+h+"']").each(function(){if($(this).attr("value")==n[h]||($(this).attr("name")==h&&$.inArray($(this).attr("value"),i)>=0)){$(this).attr("checked","checked")}})}if("INPUT"==m.toUpperCase()){if(!k||("RADIO"!=k.toUpperCase()&&"CHECKBOX"!=k.toUpperCase())){var g=$("*[loadId='"+h+"']");var l=$(g).attr("dateFormatter");var e=$(g).attr("dateNumFormatter");if(l&&null!=n[h]){var f=new Date(n[h]);$(g).val(f.format(l))}else{if(e&&null!=n[h]){$(g).val(splitDateNum(n[h],e))}else{$(g).val(n[h])}}}}if("SELECT"==m.toUpperCase()){$("#"+d).find("*[loadId='"+h+"']").find("option").each(function(){if($(this).attr("value")==n[h]){$(this).attr("selected","selected")}})}}}b(n)},function(){})}function defaultSelectInit(a,e){var b=$("#"+e).datagrid("getData")["rows"];for(var d in b){var c=b[d]["checked"];if(typeof(c)!="rowCheck"&&c){$("#"+e).datagrid("selectRow",d)}}}function addQueryCondition(a,b){createnobtnwindow("添加查询条件","commonController.do?pageattrs&pageId="+a+"&panelId="+b,1000,500)}function setQueryConditionDefault(b,a){var d=$("#"+a).val();var c="commonController.do?saveDefault";var e={"condId":d,"pageId":b};$.ax(c,e,false,"post","json",function(f){if(f.success==true){$.messager.alert("提示",f.msg,"info")}else{$.messager.alert("错误",f.msg,"error")}},function(){})}function showCustomConditionChose(e,c,a,b){var d="commonController.do?loadconds";var f={"pageId":c};$.ax(d,f,false,"post","json",function(h){var g=JSON.parse(h.result);$(e).html("");$(e).append("<option value='' selected='selected'></option>");for(rs in g){if((null!=a&&g[rs]["id"]==a)||1==g[rs]["isDefault"]){$(e).append("<option value='"+g[rs]["id"]+"' selected='selected'>"+g[rs]["name"]+"</option>")}else{$(e).append("<option value='"+g[rs]["id"]+"'>"+g[rs]["name"]+"</option>")}}},function(){});customQueryInit($(e),$(b))}function customQueryInit(w,D){var F=$(w).val();$(D).html("");if(null!=F&&F!=""&&F.length>0){var j=$(D).attr("id");var n=cache["attrSource_"+j+"_"+F];if(null==n){var g="commonController.do?loadcondattrs";var C={"condId":F};$.ax(g,C,false,"post","json",function(G){var v=JSON.parse(G.result);n=v;cache[("attrSource_"+j+"_"+F)]=n},function(){})}if(null!=n&&n.length>0){var t="";for(rs in n){var A=$.trim(n[rs]["editType"]);var q=$.trim(n[rs]["insId"]);var s=$.trim(n[rs]["attrValue"]);var l=$.trim(n[rs]["label"]);var E=$.trim(n[rs]["name"]);var m=$.trim(n[rs]["operator"]);var y=n[rs]["max"];var u=n[rs]["min"];var f=$.trim(n[rs]["type"]);var z="";z+="<span style='display:block;float:left;margin:0px 10px 10px 0px;height:22px !important;min-width:320px !important;'>"+l+"：<span name='sp_"+E+"'>";var d="<select style='margin-right:5px;width:80px !important;' id='oper_"+q+"' dateoper='true'>"+chooseOperator(f,A,m)+"<select>";switch(A){case"text":z+=d;z+="<input type='text' style='margin-right:5px;' id='"+q+"' attrId='"+q+"' name='"+E+"' value='"+s+"' min='"+u+"' max='"+y+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'>";break;case"date":if(m=="between"){z+="<input type='text' class='easyui-datetimebox' data-options='showSeconds:false' id='start_"+q+"' attrId='"+q+"' name='"+E+"' label='"+l+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'><label>&nbsp;&nbsp;—&nbsp;&nbsp;</label>";z+="<input type='text' class='easyui-datetimebox' data-options='showSeconds:false' id='end_"+q+"' attrId='"+q+"' name='"+E+"' label='"+l+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"}else{z+=d;z+="<input type='text' class='easyui-datetimebox' data-options='showSeconds:false' id='"+q+"' attrId='"+q+"' name='"+E+"' label='"+l+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'><label>&nbsp;</label>"}break;case"select":z+=d;z+="<select style='margin-right:5px;' id='"+q+"' attrId='"+q+"' name='"+E+"' class='easyui-combobox' data-options='multiple:true' label='"+l+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'></select>";break;case"checkbox":z+="<ul id='"+q+"' attrId='"+q+"' name='"+E+"' label='"+l+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'></ul>";break;case"radio":z+="<ul id='"+q+"' attrId='"+q+"' name='"+E+"' label='"+l+"' opers='"+m+"' editType='"+A+"' insId='"+q+"'></ul>";break}$(D).append(z);if(A=="date"){$.parser.parse($(D));t+=q+"&"+m+"&"+s+"#"}if(A=="select"||A=="checkbox"||A=="radio"){var a=n[rs]["dataListId"];var i=n[rs]["params"];if(A=="select"){loadSelectCombobox(q,"commonController.do?listData",a,i,E,s)}if(A=="checkbox"){reLoadOptionsData(staticDataUrl,A,q,E,a,i);var r=s.split(",");for(var p in r){$("input:checkbox[value='"+r[p]+"']").attr("checked","true")}}if(A=="radio"){reLoadOptionsData(staticDataUrl,A,q,E,a,i);var r=s.split(",");for(var p in r){$("input:radio[value='"+r[p]+"']").attr("checked","true")}}}}if(t!=null&&t!=""&&t.length>0){var o=t.split("#");if(o.length>0){for(var B in o){var x=o[B];if(x!=null&&$.trim(x)!=""){var h=x.split("&");if(null!=h&&h.length==3){var c=h[0];var b=h[1];var k=h[2];if(b=="between"){var e=k.split(",");if(e.length==2){$("#start_"+c).next("span").find("input").val(e[0]);$("#end_"+c).next("span").find("input").val(e[1])}}else{$("#"+c).next("span").find("input").val(k)}}}}}}}}}function delQueryCondition(b,a){$.messager.confirm("操作提示","您确定要执行删除操作吗？",function(e){if(e){var d=$("#"+b).val();var c="commonController.do?delcondattrs";var f={"condId":d};$.ax(c,f,false,"post","json",function(g){if("1"==g.code){$.messager.alert("提示","删除成功!","info",function(){$("#"+a).empty();$("#"+b).find("option[value='"+d+"']").remove()})}else{$.messager.alert("提示",g.msg)}},function(){})}else{}})}function showDatagridParams(a){var d=a["params"];if(typeof(d)!="undefined"){for(var b in d){var c=d[b]["key"];if(c=="message"&&!d[b]["value"]["success"]){$.messager.alert("错误",d[b]["value"]["msg"],"error")}else{$("#"+d[b]["key"]).html(d[b]["value"])}}}}function reloadTab(c){var b;if(null==c){b=self.parent.$("#maintabs").tabs("getSelected")}else{b=self.parent.$("#maintabs").tabs("getTab",c)}var a=b.panel("options").href;self.parent.$("#maintabs").tabs("update",{tab:b,options:{content:createFrame(a)}})}function analyticOperatorZh_CN(b){var a="";b=$.trim(b);switch(b){case"eq":a="等于";break;case"ne":a="不等于";break;case"gt":a="大于";break;case"lt":a="小于";break;case"ge":a="大于等于";break;case"le":a="小于等于";break;case"in":a="包含";break;case"between":a="两者之间";break;case"like":a="模糊匹配";break}return a}function analyticOperatorSymbol(b){var a="";b=$.trim(b);switch(b){case"eq":a="=";break;case"ne":a="!=";break;case"gt":a=">";break;case"lt":a="<";break;case"ge":a=">=";break;case"le":a="<=";break;case"in":a="in";break;case"between":a="between";break}return a}function chooseOperator(c,a,d){var b="";switch(a){case"text":if(c=="int"){b="eq, ne, gt, lt, ge, le"}if(c=="string"){b="eq, ne, like"}break;case"date":b=" gt, lt, ge, le";break;case"select":if(c=="int"){b="eq, ne, gt, lt, ge, le"}if(c=="string"){b="eq, ne"}break}return initOperator(b,d)}function initOperator(c,d){var b="";if(null!=c&&c!=""&&c.length>0){var a=c.split(",");if(null!=a&&a.length>0){for(var g in a){var f=$.trim(a[g]);var e=analyticOperatorZh_CN(f);if(null!=d&&f==d){b+="<option value='"+f+"' selected='selected'>"+e+"</option>"}else{b+="<option value='"+f+"'>"+e+"</option>"}}}}return b}function hideTabInit(b,a){if("true"==$("#"+b).find("#isInit").val()){$("#"+a).hide();$("#"+b).find("#isInit").val("false");$(".pagination-page-list").attr("disabled",false);$(".pagination-num").attr("disabled",false)}}function switchTabShowOrHide(c,b,a){$(c).parent().parent().children().removeClass("tabs-selected");$("#"+b).children().hide();$(c).parent().addClass("tabs-selected");$("#"+a).show()}function getCheckedIds(c,b,e){var d=$("#"+c).find("input[name='ck']:checked");var a="";$(d).each(function(f){var g=$(this).parents("tr").attr("datagrid-row-index");var h=$("#"+b).datagrid("getRows")[g][e];if(typeof(h)!="undefined"){a+=h;if(f!=d.length-1){a+=","}}});return a}$.extend($.fn.datagrid.methods,{fixRownumber:function(a){return a.each(function(){var b=$(this).datagrid("getPanel");var d=$(".datagrid-cell-rownumber",b).last().clone();d.css({"position":"absolute",left:-1000}).appendTo("body");var c=d.width("auto").width();if(c>25){$(".datagrid-header-rownumber,.datagrid-cell-rownumber",b).width(c+5);$(this).datagrid("resize");d.remove();d=null}else{$(".datagrid-header-rownumber,.datagrid-cell-rownumber",b).removeAttr("style")}})}});function clearNoNum(a){a.value=a.value.replace(/[^\d.]/g,"");a.value=a.value.replace(/^\./g,"");a.value=a.value.replace(/\.{2,}/g,".");a.value=a.value.replace(".","$#$").replace(/\./g,"").replace("$#$",".");a.value=a.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")}function timeCycleEvent(j,c,g,i,d,e,a){var h=$("#"+i).val();if(h!=0){$.messager.alert("错误","下载中，请稍后。。。。。。","error");return}var b=$("#"+j).datagrid("options").queryParams["conditions"];var f=JSON.stringify(b);if("{}"!=f){$("#"+c).find("#conditions").val(b)}$("#"+c).submit();$("#"+d).show();var e=setInterval(function(){$.ax("commonController.do?getProgress",{"progressKey":g},false,"post","json",function(l){var k=l.progress==null?h:l.progress;$("#"+d).progressbar({value:k});$("#"+i).val(k);if("100"==k){clearInterval(e);$("#"+i).val(0);$("#"+d).hide();$("#"+d).progressbar({value:0});$.messager.alert("提示","下载完成","info")}if("101"==k||null==k){k=0;clearInterval(e);$("#"+d).hide();$("#"+i).val(0);$("#"+d).progressbar({value:0});$.messager.alert("错误","数据异常,下载失败","error")}},function(){clearInterval(e);$("#"+d).hide();$("#"+i).val(0);$("#"+d).progressbar({value:0});$.messager.alert("错误","数据异常,下载失败","error")})},a)}function loadSelectCombobox(g,d,b,e,c,a){var f=cache["listdata_"+b+"_"+e];if(f||null==f){params={"datalistId":b,"params":e};if(null==d){d="commonController.do?listData"}$.ax(d,params,false,"post","json",function(i){var h=$.parseJSON(i.result);f=h;cache[("listdata_"+b+"_"+e)]=h},function(){})}$("#"+g).combobox({data:f,valueField:"key",textField:"value",panelHeight:"200",onLoadSuccess:function(){var i=f;if(null!=i&&null!=a){for(var h in i){if(a==i[h]["key"]){$(this).combobox("setText",i[h]["value"]);$(this).combo("panel").find("div.combobox-item:eq("+h+")").addClass("combobox-item-selected");$(this).combo("textbox").after("<input type='hidden' class='textbox-value' name='"+c+"' value='"+a+"'>")}}}}})}function splitDateNum(e,a){var h="";var c="";var f="";var b="";var g="";var d="";if(null!=e&&$.trim(e)!=""){if(e.length>=4){h=e.substring(0,4)}if(e.length>=6){c="-"+e.substring(4,6)}if(e.length>=8){f="-"+e.substring(6,8)}if(e.length>=10){b=" "+e.substring(8,10)}if(e.length>=12){g=":"+e.substring(10,12)}if(e.length>=14){d=":"+e.substring(12,14)}}return h+c+f+b+g+d}function changeTwoDecimal_f(a){var b=parseFloat(a);if(isNaN(b)){alert("function:changeTwoDecimal->parameter error");return false}var b=Math.round(a*100)/100;var c=b.toString();var d=c.indexOf(".");if(d<0){d=c.length;c+="."}while(c.length<=d+2){c+="0"}return c}$(function(){$("input").live("change",function(){if(typeof($(this).attr("notVerifiedCharacter"))==="undefined"){var b=$(this).attr("class");if(b==null||b.indexOf("textbox")<0){var a=$(this).val();a=a.replace(/(["'<>])/g,"").replace(/(^\s+)|(\s+$)/g,"");$(this).val(a)}}});$("input").live("keyup",function(){if(typeof($(this).attr("notVerifiedCharacter"))==="undefined"){var b=$(this).attr("class");if(b==null||b.indexOf("textbox")<0){var a=$(this).val();a=a.replace(/(["'<>])/g,"").replace(/(^\s+)|(\s+$)/g,"");$(this).val(a)}}});$("input").live("keydown",function(){if(typeof($(this).attr("notVerifiedCharacter"))==="undefined"){var b=$(this).attr("class");if(b==null||b.indexOf("textbox")<0){var a=$(this).val();a=a.replace(/(["'<>])/g,"").replace(/(^\s+)|(\s+$)/g,"");$(this).val(a)}}});$("input").live("keypress",function(){if(typeof($(this).attr("notVerifiedCharacter"))==="undefined"){var b=$(this).attr("class");if(b==null||b.indexOf("textbox")<0){var a=$(this).val();a=a.replace(/(["'<>])/g,"").replace(/(^\s+)|(\s+$)/g,"");$(this).val(a)}}})});function checkedStatus(b,c){var a=$("#"+b).find("#"+c);if(a){setChildCheckBox(b,a);setParentCheckBox(b,a)}}function findChildCheckBox(d,b){var a=new Array();if(b){var c=$(b).attr("id");var e=$("#"+d).find("input[parentId='"+c+"']");if(e){$(e).each(function(){a.push($(this))})}}return a}function findBrotherCheckBox(c,b){var a=new Array();if(b){var e=$(b).attr("parentId");if(e){var d=$("#"+c).find("input[parentId='"+e+"']");if(d){$(d).each(function(){a.push($(this))})}}}return a}function findParentCheckBox(c,b){var a=null;var d=$(b).attr("parentId");if(d){a=$("#"+c).find("input[id='"+d+"']")}return a}function setChildCheckBox(e,b){var a=$(b).attr("checked")==="checked"?true:false;var d=findChildCheckBox(e,b);if(d.length>0){for(var c=0;c<d.length;c++){if($(d[c])){$(d[c]).attr("checked",a);setChildCheckBox(e,d[c])}}}}function setParentCheckBox(g,c){var d=false;var b=findParentCheckBox(g,c);if(b){var f=findBrotherCheckBox(g,c);console.log(f.length);if(f.length>0){for(var e=0;e<f.length;e++){if($(f[e])){var a=$(f[e]).attr("checked")==="checked"?true:false;if(a){d=true;break}}}}$(b).attr("checked",d);setParentCheckBox(g,b)}};function chengeDgFildsSlide(panel,fieldDiv,uploadExcelFrm){if($("#"+panel).find("#"+fieldDiv).is(":visible")){$("#"+panel).find("#"+fieldDiv).slideUp();$("#"+panel).find(".moreSelect").css("background-position","90% 0")}else{$("#"+panel).find("#"+fieldDiv).slideDown();$("#"+panel).find(".moreSelect").css("background-position","10% 0")}var selCks=$("#"+panel).find("input[type='checkbox']");var showFields=$("#"+uploadExcelFrm).find("#fields").val();$(selCks).each(function(){var _showFields=showFields.split(",");var f=$(this).val();var isShow=_showFields.indexOf(f)==-1?false:true;$(this).attr("checked",isShow)})}function refreshDgFieldsDisplay(dgId,panel,uploadExcelFrm){var selCks=$("#"+panel).find("input[type='checkbox']");var showCks=$("#"+panel).find("input:checked");if(showCks.length===0){$.messager.alert("错误","不能隐藏所有的列！","error");return}var showFields="";$(selCks).each(function(){var isShow=$(this).attr("checked")==="checked"?true:false;var field=$(this).val();if(isShow){showFields+=field+",";$("#"+dgId).datagrid("showColumn",field)}else{$("#"+dgId).datagrid("hideColumn",field)}});$("#"+uploadExcelFrm).find("#fields").val(showFields);var url="commonController.do?saveDgFields";var params={"dgName":dgId,"dgFields":showFields};$.ax(url,params,function(data){})}function loadDgFields(dgId,panel,uploadExcelFrm){var url="commonController.do?loadDgFields";var params={"dgName":dgId};$.ax(url,params,false,"post","json",function(data){var showFields=data.result;if(null!=showFields&&""!=showFields&&typeof(showFields)!="undefined"){$("#"+uploadExcelFrm).find("#fields").val(showFields);var selCks=$("#"+panel).find("input[type='checkbox']");$(selCks).each(function(){var _showFields=showFields.split(",");var f=$(this).val();var isShow=_showFields.indexOf(f)==-1?false:true;if(isShow){$("#"+dgId).datagrid("showColumn",f)}else{$("#"+dgId).datagrid("hideColumn",f)}})}},function(){})};function getDgQueryParamsStrs(formObj){var queryParamObjs=$("#"+formObj).children(".commSearchCond");var conditions=[];$(queryParamObjs).each(function(){var curDiv=$(this);if(curDiv.attr("hideEffect")!=null&&curDiv.attr("hideEffect")!="undefined"&&curDiv.attr("hideEffect")=="false"){if(!curDiv.is(":visible")){return}}var queryParamIpts=curDiv.find(":input[name]");var condition={};condition["name"]=curDiv.attr("name");condition["params"]=[];$(queryParamIpts).each(function(){if(typeof($(this).attr("name"))!="undefined"){var name=$(this).attr("name");if($(this)[0].tagName.toUpperCase()=="SELECT"){var selOpts=$(this).find("option:selected");$(selOpts).each(function(){var value=$(this).attr("value");if(null!=value&&value.length>0){var optPair={};optPair["key"]=name;optPair["value"]=value;optPair["type"]=$(this).attr("type");if(typeof($(this).attr("attrId"))!="undefined"){var attrId=$(this).attr("attrId");if($("#oper_"+attrId).length>0){var attrOper=$("#oper_"+attrId).val();if(null!=attrOper&&attrOper.length>0&&attrOper!=""){optPair["operator"]=attrOper}else{if(typeof($(this).attr("opers"))!="undefined"){optPair["operator"]=$(this).attr("opers")}}}}condition["params"].push(optPair)}})}else{if($(this).attr("type").toUpperCase()=="CHECKBOX"||$(this).attr("type").toUpperCase()=="RADIO"){if($(this).prop("checked")){var value=$(this).attr("value");if(null!=value&&value.length>0){var optPair={};optPair["key"]=name;optPair["value"]=value;optPair["type"]=$(this).attr("type");if(typeof($(this).attr("attrId"))!="undefined"){var attrId=$(this).attr("attrId");if($("#oper_"+attrId).length>0){var attrOper=$("#oper_"+attrId).val();if(null!=attrOper&&attrOper.length>0&&attrOper!=""){optPair["operator"]=attrOper}else{if(typeof($(this).attr("opers"))!="undefined"){optPair["operator"]=$(this).attr("opers")}}}}condition["params"].push(optPair)}}}else{var value=$(this).attr("value");if(null!=value&&value.length>0){var optPair={};optPair["key"]=name;optPair["value"]=value;optPair["type"]=$(this).attr("type");if($(this).attr("type").toUpperCase()=="HIDDEN"){var dateopr=$(this).parents("span[name='sp_"+name+"']").find("*[dateoper='true']");if(typeof(dateopr)!="undefined"){optPair["operator"]=$(dateopr).val();var operId=$(dateopr).attr("id");if(typeof(operId)!="undefined"){var attrId=operId.replace("oper_","");if(typeof($("#"+attrId))!="undefined"&&typeof($("#"+attrId).attr("edittype"))!="undefined"){optPair["attrType"]=$("#"+attrId).attr("edittype")}}}}else{if(typeof($(this).attr("attrId"))!="undefined"){var attrId=$(this).attr("attrId");if($("#oper_"+attrId).length>0){var attrOper=$("#oper_"+attrId).val();if(null!=attrOper&&attrOper.length>0&&attrOper!=""){optPair["operator"]=attrOper}else{if(typeof($(this).attr("opers"))!="undefined"){optPair["operator"]=$(this).attr("opers")}}}}}condition["params"].push(optPair)}}}}});conditions.push(condition)});return JSON.stringify(conditions)};function isChangeQuery(frm,dg){var queryStrs='"'+getDgQueryParamsStrs(frm)+'"';var params=$("#"+dg).datagrid("options").queryParams["conditions"];var queryParmas=JSON.stringify(params).replace(/\\/g,"");if(queryStrs!=queryParmas){return true}return false};